<!DOCTYPE html>
<html>
    <head>
        <title>
            CVODESolver Plugin
        </title>

        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>

        <link href="../../res/stylesheet.css" rel="stylesheet" type="text/css"/>

        <script src="../../../3rdparty/jQuery/jquery.js" type="text/javascript"></script>
        <script src="../../../res/common.js" type="text/javascript"></script>
        <script src="../../res/menu.js" type="text/javascript"></script>
    </head>
    <body ondragstart="return false;" ondrop="return false;">
        <script type="text/javascript">
            headerAndContentsMenu("CVODESolver Plugin", "../../..");
        </script>

        <p>
            The CVODESolver plugin uses <a href="https://computation.llnl.gov/casc/sundials/description/description.html#descr_cvode">CVODE</a> to solve ODEs and it can be customised through the following properties:
        </p>

        <ul>
            <li>
                <strong>Maximum step:</strong> the maximum step used by the solver (default: <code>0</code>).

                <p class="nomargins note">
                    the default value of <code>0</code> means that <a href="https://computation.llnl.gov/casc/sundials/description/description.html#descr_cvode">CVODE</a> will try to use as big a step as possible.
                </p>
            </li>
        </ul>

        <ul>
            <li>
                <strong>Maximum number of steps:</strong> the maximum number of (internal) steps used by the solver between two given points (default: <code>500</code>).

                <p class="nomargins note">
                    the default value of <code>500</code> should be big enough for most models. However, some (very) stiff models may require this value to be increased.
                </p>
            </li>
        </ul>

        <ul>
            <li>
                <strong>Integration method:</strong> the integration method used by the solver (default: <code>BDF</code>)

                <p class="nomargins note note1">
                    <code>BDF</code> and <code>Adams-Moulton</code> can be used.
                </p>
                <p class="nomargins note note2">
                    <code>BDF</code> can be used with either stiff or non-stiff models while <code>Adams-Moulton</code> should only be used with non-stiff models.
                </p>
            </li>
        </ul>

        <ul>
            <li>
                <strong>Iteration type:</strong> the type of iteration used by the solver (default: <code>Newton</code>).

                <p class="nomargins note note1">
                    <code>Newton</code> and <code>Functional</code> can be used.
                </p>
                <p class="nomargins note note2">
                    <code>Newton</code> can be used with either stiff or non-stiff models while <code>Functional</code> should only be used with non-stiff models.
                </p>
                <p class="nomargins note note3">
                    to use a <code>Newton</code> iteration requires solving a system of linear equations and therefore requires specifying a linear solver.
                </p>
            </li>
        </ul>

        <ul>
            <li>
                <strong>Linear solver:</strong> the linear solver used by the solver during a <code>Newton</code> iteration (default: <code>Dense</code>).

                <p class="nomargins note note1">
                    <code>Dense</code>, <code>Banded</code>, <code>Diagonal</code>, <code>GMRES</code>, <code>BiCGStab</code> and <code>TFQMR</code> can be used.
                </p>
                <p class="nomargins note note2">
                    <code>Banded</code> requires specifying both an upper and a lower half-bandwidth value.
                </p>
                <p class="nomargins note note3">
                    <code>GMRES</code>, <code>BiCGStab</code> and <code>TFQMR</code> require specifying whether to use a preconditioner.
                </p>
            </li>
        </ul>

        <ul>
            <li>
                <strong>Preconditioner:</strong> the preconditioner, if any, used by the solver when using a <code>GMRES</code>, <code>BiCGStab</code> or <code>TFQMR</code> linear solver during a <code>Newton</code> iteration (default: <code>Banded</code>).

                <p class="nomargins note note1">
                    <code>Banded</code> and <code>None</code> can be used.
                </p>
                <p class="nomargins note note2">
                    <code>Banded</code> requires specifying both an upper and a lower half-bandwidth value.
                </p>
            </li>
        </ul>

        <ul>
            <li>
                <strong>Upper half-bandwidth:</strong> the upper half-bandwidth value used by the <code>Banded</code> linear solver or preconditioner (default: <code>0</code>).

                <p class="nomargins note">
                    the upper half-bandwidth value must be between <code>0</code> and <code>n-1</code> with <code>n</code> the number of ODEs in the model.
                </p>
            </li>
        </ul>

        <ul>
            <li>
                <strong>Lower half-bandwidth:</strong> the lower half-bandwidth value used by the <code>Banded</code> linear solver or preconditioner (default: <code>0</code>).

                <p class="nomargins note">
                    the lower half-bandwidth value must be between <code>0</code> and <code>n-1</code> with <code>n</code> the number of ODEs in the model.
                </p>
            </li>
        </ul>

        <ul>
            <li>
                <strong>Relative tolerance:</strong> the relative tolerance used by the solver (default: <code>10<sup>-7</sup></code>).
            </li>
        </ul>

        <ul>
            <li>
                <strong>Absolute tolerance:</strong> the absolute tolerance used by the solver (default: <code>10<sup>-7</sup></code>).
            </li>
        </ul>

        <ul>
            <li>
                <strong>Interpolate solution:</strong> whether the solver returns an interpolated solution (default: <code>True</code>).
            </li>
        </ul>

        <p>
            The default settings should work with most models. However, some models may require some minor adjustments. This is the case with cardiac cellular electrophysiological models that need a stimulus protocol to generate an action potential. Such a protocol is likely to be ignored by <a href="https://computation.llnl.gov/casc/sundials/description/description.html#descr_cvode">CVODE</a>, if <strong>Maximum step</strong> and <strong>Interpolate solution</strong> are set to their default values of <code>0</code> and <code>True</code>, respectively. To address this issue, you can either set <strong>Maximum step</strong> to the length of the stimulus protocol or set <strong>Interpolate solution</strong> to <code>False</code>. The former approach will yield (slightly) less accurate results, but they will be obtained (much) faster.
        </p>

        <script type="text/javascript">
            copyright("../../..");
        </script>
    </body>
</html>
